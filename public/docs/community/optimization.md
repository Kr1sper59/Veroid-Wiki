# Как оптимизировать свой сервер Minecraft

Шаг 1 - Железо и ядра

Перед созданием своего сервера, нужно понять, какой тариф нужно купить. Для ванильных проектов до 20 игроков хватит 4-6ГБ ОЗУ. Для проектов с модами от 8ГБ ОЗУ.
Очень важно учесть! Нельзя давать всю оперативную память системы. Нужно оставить 2 и более ГБ ОЗУ для операционной системы и других процессов.

Ядро нужно выбирать с умом. 
Vanila (или же официальное ядро). Подойдет для простой игры с друзьями или проекта нацеленного на выживание (но тут не обойтись доверием людей, нужно ставить авторизацию, а ванильное ядро для таких целей не подойдет.
PaperMC - Расширенное ядро которое активно обновляется, исправлено много ошибок в отличии от Spigot. Само ядро предназначено для игры с плагинами. Плагины - Это мини программа, работающая только на стороне сервера.
Скачать можно здесь: https://papermc.io/downloads
Purpur/Pufferfish - Это форки Paper с большими улучшениями, также являются более оптимизированными и поддерживают некоторые плагины, которых нет на самом Paper!
Скачать можно здесь: https://purpurmc.org/
Fabric + Lithium/Starlight - Сделан для игры с модами, а после + указаны плагины дающие оптимизацию
Mohist - Ядро для игры с модами Forge, а также поддержкой плагинов Paper.


Шаг 2 - Тонкая настройка сервера

Если вы разбираетесь в работе серверов, знаете что при запуске идут флаги запуска (Java аргументы)
Выделим в них важные параметры:

``-Xms4G -Xmx6G:`` лимиты ОЗУ. В данном параметре написано сколько От и До ГБ озу должно быть выделено

``-XX:+UseG1GC:`` Современный и эффективный сборщик мусора.
Конфиг ядра ( в данном примере рассмотрим самый популярный - Paper.
ищем эти ключевые настройки:

```\# Чанки и генерация
chunks:
  autosave-interval: 120 \# Сохранять чанки раз в 6 сек (120 тиков) вместо 45 сек по умолчанию! Меньше лагов при сохранении.
  max-auto-save-chunks-per-tick: 24 \# Сколько чанков сохранять за тик. Увеличивай осторожно, если на сервере много активных зон.
entity:
  tracking-range:
    players: 48 \# Дистанция видимости игроков. Снижай для разгрузки (например, до 32-40).
    monsters: 32 \# Дистанция видимости мобов.
    animals: 32 \# Дистанция видимости животных.
    misc: 16 \# Дистанция видимости предметов, стрел и т.д.
  activation-range:
    animals: 16 \# На каком расстоянии животные "оживают". Снижай!
    monsters: 24 \# На каком расстоянии мобы "оживают".
    raiders: 48 \# Для рейдов.
    misc: 8 \# Для нежити (лодки, вагонетки).
    water: 8 \# Для водных мобов.
    villagers: 16 \# Для жителей.
    flying-monsters: 48 \# Для летающих мобов (Гасты).
\# Оптимизация мобов
mob-spawner:
  tick-rate: 2 \# Как часто спавнеры пытаются спавнить. Увеличивай (до 3-5) для снижения нагрузки.
spawner:
  fixed-rate:  \# Еще больше контроля над спавнерами
    enabled: true
    value: 3
\# Оптимизация Redstone (БОЛЬШОЙ эффект!)
tick-rates:
  sensor:
    villager: 40 \# Как часто сенсоры жителей обновляются. Увеличивай!
    secondary: 20
  processor:
    villager: 40 \# Как часто процессоры жителей обновляются. Увеличивай!
hopper:
  disable-move-event: true \# РЕКОМЕНДУЕТСЯ. Отключает сложные события для воронок, сильно снижает лаг.
```

Шаг 3 - Плагины и Моды
Ревизия плагиов/модов
1. Удалите все ненужное. Каждый плагин/мод - нагрузка.
2. Ищите аналоги легче. Например: Вместо WorldEdit использовать FAWE (fast async world edit)
3. Античиты: Vulcan, Matrix - мощные, но тяжелые. NoCheatPlus или GrimAC могут быть легче
Плагины для оптимизации:
ClearLag - Критически важный плагин, автоматически очищает предметы, валяющиеся в мире, а также мобов выше лимита в мире. 
Chunky - Прогрузка чанков. Спасает от лагов при хождении по миру, от не прогруженных чанков.
Spark - Профилировщик. Покажет вам когда тормозит сервер, и также покажет отчёт.
Оптимизационные Моды (Fabric/Quilt/Forge):
Lithium - Общая оптимизация механик
FerriteCore - Оптимизация использования памяти
Krypton - Оптимизация сети
Sodium - Клиентский, но если на сервере есть Iris, то нужен.

Автор статьи - roudezz